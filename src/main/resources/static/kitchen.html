<!doctype html>
<html lang="it"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Kitchen</title></head>
<body>
<h1>Kitchen Dashboard</h1>
<div id="totals"></div>
<div id="stats"></div>
<div id="orders"></div>
<script>
async function load(){
  const [tot, ord, st] = await Promise.all([
    fetch('/gettotali').then(r=>r.json()),
    fetch('/getordini?status=NEW,IN_PROGRESS,READY,DONE&sinceMinutes=1440').then(r=>r.json()),
    fetch('/admin/counters').then(r=>r.json())
  ]);
  document.getElementById('totals').textContent = 'Ordini per stato: '+JSON.stringify(tot);
  document.getElementById('stats').textContent = 'Storico cumulato: '+JSON.stringify(st);
  document.getElementById('orders').innerHTML = ord.map(o=>`<div><b>${o.status}</b> Tavolo ${o.tableNo||'-'} Totale ${o.totalAmount} € - ${(o.items||[]).map(i=>`${i.name} x${i.qty} (${i.lineTotal}€)`).join(', ')}</div>`).join('');
}
setInterval(load,3000); load();
</script>
</body></html>
